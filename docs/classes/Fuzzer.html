<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Fuzzer</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Fuzzer</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/src/fuzzer_rb.html">
                src/fuzzer.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="Object.html">
                Object
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The <a href="Fuzzer.html">Fuzzer</a> class is a simple metafuzzing example.
It will attempt to send sensible fuzzing output based on the types of
fields within the structure. <a href="Fuzzer.html">Fuzzer</a> allows the
user to specify &#8216;fixup&#8217; code blocks that will be run in order,
using output chaining, on the fuzzed structure element. Some examples might
be blocks that encrypt or encode the data, correct length fields, calculate
checksums or simply add to the confusion by randomly messing with the
output.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000067">basic_tests</a>&nbsp;&nbsp;
      <a href="#M000066">new</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="Mutations.html">Mutations</a></span>
      </div>
    </div>

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000066" class="method-detail">
        <a name="M000066"></a>

        <div class="method-heading">
          <a href="Fuzzer.src/M000066.html" target="Code" class="method-signature"
            onclick="popupCode('Fuzzer.src/M000066.html');return false;">
          <span class="method-name">new</span><span class="method-args">(binstruct, *fixups)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
binstruct is a kind_of? <a href="BinStruct.html">BinStruct</a>. *fixups is
an array of Proc objects or lambdas which can do things like correct
lengths within the structure, calculate checksums and so forth. The fixups
will be applied cumulatively in the order specified. REMEMBER that the
fixups need to be able to deal with the fact that the fields may not all be
kind_of? Field::Field if some extension code or a previous fixup has messed
with the obj#fields Array directly.
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000067" class="method-detail">
        <a name="M000067"></a>

        <div class="method-heading">
          <a href="Fuzzer.src/M000067.html" target="Code" class="method-signature"
            onclick="popupCode('Fuzzer.src/M000067.html');return false;">
          <span class="method-name">basic_tests</span><span class="method-args">( coverage=&quot;corner&quot;, overflow_maxlen=5000, send_unfixed=true ) {|fuzzed_item| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Run three basic sets of tests for each field.
</p>
<ol>
<li>Enumerate possible field values (replace)

</li>
<li>Delete the field from the structure (delete)

</li>
<li>Insert overflow elements into the structure before each field (and at the
end) (inject)

</li>
</ol>
<p>
Each fuzzed structure will be yielded with and without fixup procedures
applied if the send_unfixed paramter is true (which is the default).
</p>
<p>
Example:
</p>
<pre>
 f=Fuzzer.new(ExampleStruct.new)
 f.basic_tests(&quot;corner&quot;, 1500, false) {|pkt| some_socket.send(pkt,0)}
</pre>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>